% --------------- %
% ---  JOB    --- %
% --------------- %

Job: "job_m_{p_mass:03d}_dnn_p{p_dnn_cut_label}_sys"
  CmeLabel: "13 TeV"
  POI: "g"
  ReadFrom: NTUP
  NtuplePaths: "{p_ntuple_path}"
  Label: "Four Muon"
  LumiLabel: "140.0 fb^{{-1}}"    % data17?
  Lumi: 140
  NtupleName: "ntup"
  DebugLevel: 0
  MCstatThreshold: 5%
  HistoChecks: NOCRASH
  % StatOnly: TRUE
  SplitHistoFiles: TRUE   % set this in order to have separated .root files in Histograms/ for different regions
  ImageFormat: "png","pdf"
  DoSignalRegionsPlot: TRUE
  DoPieChartPlot: TRUE
  

% --------------- %
% ---  FIT    --- %
% --------------- %

Fit: "fit"
  FitRegion: CRSR
  FitType: SPLUSB
  POIAsimov: 0
  FitBlind: TRUE
  doLHscan: "g"

% --------------- %
% ---  LIMIT    --- %
% --------------- %

Limit: "limit"
  LimitType: ASYMPTOTIC
  LimitBlind: TRUE
  SignalInjection: FALSE
  SignalInjectionValue: 1.0


% -------------------- %
% --- Significance --- %
% -------------------- %
Significance: "significance"
  SignificanceBlind: TRUE
  POIAsimov: 1


% --------------- %
% --- REGIONS --- %
% --------------- %

Region: "ZZ4l_CR"
  Type: CONTROL
  Selection: "(mz1 > {p_mass_cut_high}) || (mz1 < {p_mass_cut_low}) && (dnn_out > {p_dnn_cut})"
  Variable: "mz1",10,0,80
  VariableTitle: "mz1"
  Label: "Control Region"
  ShortLabel: "CR,4muon"

Region: "Zprime_SR"
  Type: SIGNAL
  Selection: "(mz1 > {p_mass_cut_low}) && (mz1 < {p_mass_cut_high}) && (dnn_out > {p_dnn_cut})"
  Variable: "mz1",5,{p_mass_cut_low},{p_mass_cut_high}
  VariableTitle: "mz1"
  Label: "Signal Region"
  ShortLabel: "SR,4muon"

% --------------- %
% --- SAMPLES --- %
% --------------- %

Sample: "Zprime"
  Type: SIGNAL
  Title: "Zprime"
  FillColor: 2
  LineColor: 2
  NtupleFile: "sig_Zp{p_mass:03d}"
  %NormFactor: "muZprime",1,-10,100
  MCweight: "weight"

Sample: "ZZ4l"
  Type: BACKGROUND
  Title: "ZZ4l"
  FillColor: 4
  LineColor: 4
  NtupleFile: "bkg_qcd"
  MCweight: "weight"

%Sample: "DD"
%  Type: BACKGROUND
%  Title: "DD"
%  FillColor: 434
%  LineColor: 434
%  NtupleFile: "tree_DD"
%  MCweight: "weight"
%  NormalizedByTheory: FALSE

% --------------- %
% - NORMFACTORS - %
% --------------- %

NormFactor: "g"
  Title: "#sigma(fb)"
   Nominal: 1
   Min: 0
   Max: 3
   Samples: Zprime

NormFactor: "muZZ4l"
  Title: "#mu (ZZ4l)"
  Min: 0
  Max: 10
  Nominal: 1
  % Constant: TRUE
  Samples: ZZ4l

% NormFactor: "muLumi"
%   Title: "Lumi Scale"
%   Min: 0
%   Max: 100
%   Nominal: 1
%   Constant: TRUE
%   Samples: all


% --------------- %
% - SYSTEMATICS - %
% --------------- %

%% Overall Systematics

  Systematic: "LUMI"
    Title: "Luminosity"
    Type: OVERALL
    Samples: all
    OverallUp: 0.021
    OverallDown: -0.021
    Category: Lumi


%% weight Systematics

  Systematic: "weight_QCD_SCALE_MZ1"
    Title: "weight_QCD_SCALE_MZ1"
    Type: HISTO
    Samples: ZZ4l
    Regions: ZZ4l_CR, Zprime_SR
    NtuplePathsUp: "/data/zprime/ntuples_fit/1220-sys/tree_NOMINAL/mc16d"
    NtuplePathsDown: "/data/zprime/ntuples_fit/1220-sys/tree_NOMINAL/mc16d"
    NtupleFilesUp: "bkg_qcd"
    NtupleFilesDown: "bkg_qcd"
    NtupleNameUp: "ntup"
    NtupleNameDown: "ntup"
    Symmetrisation: TWOSIDED
    WeightUp: weight_qcd_scale_up_mz1*139/43.9
    WeightDown: weight_qcd_scale_down_mz1*139/43.9


%% p4 Systematics

%  Systematic: "EG_RESOLUTION_ALL__1down"
%    Title: "EG_RESOLUTION_ALL__1down"
%    Type: HISTO
%    Samples: ZZ4l, Zprime
%    Regions: ZZ4l_CR, Zprime_SR
%    NtuplePathsUp: "/data/zprime/ntuples_fit/1220-sys/tree_EG_RESOLUTION_ALL__1up/mc16d"
%    NtuplePathsDown: "/data/zprime/ntuples_fit/1220-sys/tree_EG_RESOLUTION_ALL__1down/mc16d"
%    NtupleFilesUp: "bkg_qcd,sig_Zp042"
%    NtupleFilesDown: "bkg_qcd"
%    NtupleNameUp: "ntup"
%    NtupleNameDown: "ntup"
%    Symmetrisation: TWOSIDED
